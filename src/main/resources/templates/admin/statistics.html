<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thống kê Doanh thu</title>
    <link rel="stylesheet" href="/css/admin/common.css">
    <link rel="stylesheet" href="/css/admin/hide.css">
    <link rel="stylesheet" href="/css/admin/statistics.css">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/icon/computer.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

<div class="loading-screen" id="loadingScreen">
    <div class="spinner"></div>
    <div>Đang xác thực quyền truy cập...</div>
</div>

<div class="admin-wrapper" id="adminContent">
    <div th:replace="~{admin/common :: common}"></div>

    <main class="main-content">
        <header class="topbar">
            <h1>Quản lý Đơn hàng</h1>
            <div class="user-info">
                <span>Xin chào, <strong id="admin-username"></strong></span>
                <button id="admin-logout-btn" class="logout-small">
                    <i class="fas fa-sign-out-alt"></i> Đăng xuất
                </button>
            </div>
        </header>

        <div class="content-wrapper">
            <div class="filter-card">
                <h3><i class="fas fa-filter"></i> Lọc theo thời gian</h3>
                <div class="filter-form">
                    <div class="form-group">
                        <label for="startDate">Từ ngày:</label>
                        <input type="date" id="startDate" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="endDate">Đến ngày:</label>
                        <input type="date" id="endDate" class="form-control">
                    </div>
                    <button id="filterBtn" class="btn btn-primary">
                        <i class="fas fa-search"></i> Áp dụng
                    </button>
                    <button id="resetBtn" class="btn btn-secondary">
                        <i class="fas fa-redo"></i> Mặc định (30 ngày)
                    </button>
                </div>
            </div>

            <div class="stats-overview">
                <div class="stat-card revenue">
                    <div class="stat-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Tổng doanh thu</h3>
                        <p class="stat-value" id="totalRevenue">0 ₫</p>
                        <p class="stat-period" id="revenuePeriod"></p>
                    </div>
                </div>

                <div class="stat-card orders">
                    <div class="stat-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Đơn hàng hoàn thành</h3>
                        <p class="stat-value" id="completedOrders">0</p>
                        <p class="stat-period" id="ordersPeriod"></p>
                    </div>
                </div>

                <div class="stat-card average">
                    <div class="stat-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Giá trị trung bình</h3>
                        <p class="stat-value" id="averageOrder">0 ₫</p>
                        <p class="stat-period">trên mỗi đơn hàng</p>
                    </div>
                </div>

                <div class="stat-card total-orders">
                    <div class="stat-icon">
                        <i class="fas fa-clipboard-list"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Tổng đơn hàng</h3>
                        <p class="stat-value" id="totalOrders">0</p>
                        <p class="stat-period" id="totalOrdersPeriod"></p>
                    </div>
                </div>
            </div>

            <!-- Biểu đồ và bảng -->
            <div class="charts-section">
                <div class="chart-container">
                    <h3><i class="fas fa-chart-line"></i> Doanh thu theo ngày</h3>
                    <canvas id="revenueChart"></canvas>
                </div>

                <div class="chart-container">
                    <h3><i class="fas fa-chart-pie"></i> Trạng thái đơn hàng</h3>
                    <canvas id="orderStatusChart"></canvas>
                </div>
            </div>

            <!-- Top sản phẩm bán chạy -->
            <div class="top-products-section">
                <h3><i class="fas fa-trophy"></i> Top 10 doanh thu theo sản phẩm</h3>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                        <tr>
                            <th>STT</th>
                            <th>Sản phẩm</th>
                            <th>Số lượng bán</th>
                            <th>Doanh thu</th>
                            <th>Tên sản phẩm</th>
                        </tr>
                        </thead>
                        <tbody id="topProductsTable">
                        <!-- Dữ liệu sẽ được thêm bằng JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="/js/admin/common.js" defer></script>
<script src="/js/user/auth.js" defer></script>
<script src="/js/admin/statistics.js"></script>
</body>
</html>